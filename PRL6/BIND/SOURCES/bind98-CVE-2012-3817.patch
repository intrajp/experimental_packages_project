diff -up bind-9.8.2rc1/lib/dns/resolver.c.CVE-2012-3817 bind-9.8.2rc1/lib/dns/resolver.c
--- bind-9.8.2rc1/lib/dns/resolver.c.CVE-2012-3817	2012-07-25 13:54:05.906590992 +0200
+++ bind-9.8.2rc1/lib/dns/resolver.c	2012-07-25 13:54:34.490055444 +0200
@@ -8422,6 +8422,7 @@ dns_resolver_addbadcache(dns_resolver_t
 			goto cleanup;
 		bad->type = type;
 		bad->hashval = hashval;
+		bad->expire = *expire;
 		isc_buffer_init(&buffer, bad + 1, name->length);
 		dns_name_init(&bad->name, NULL);
 		dns_name_copy(name, &bad->name, &buffer);
@@ -8433,8 +8434,8 @@ dns_resolver_addbadcache(dns_resolver_t
 		if (resolver->badcount < resolver->badhash * 2 &&
 		    resolver->badhash > DNS_BADCACHE_SIZE)
 			resizehash(resolver, &now, ISC_FALSE);
-	}
-	bad->expire = *expire;
+	} else
+		bad->expire = *expire;
  cleanup:
 	UNLOCK(&resolver->lock);
 }
