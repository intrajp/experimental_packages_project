diff -up bind-9.8.2rc1/bin/named/query.c.CVE-2012-5688 bind-9.8.2rc1/bin/named/query.c
--- bind-9.8.2rc1/bin/named/query.c.CVE-2012-5688	2012-12-05 10:33:54.526491128 +0100
+++ bind-9.8.2rc1/bin/named/query.c	2012-12-05 10:34:12.517509296 +0100
@@ -5094,10 +5094,12 @@ dns64_ttl(dns_db_t *db, dns_dbversion_t
 	isc_result_t result;
 	isc_uint32_t ttl = ISC_UINT32_MAX;
 
+	dns_rdataset_init(&rdataset);
+
 	result = dns_db_getoriginnode(db, &node);
 	if (result != ISC_R_SUCCESS)
 		goto cleanup;
-	dns_rdataset_init(&rdataset);
+
 	result = dns_db_findrdataset(db, node, version, dns_rdatatype_soa,
 				     0, 0, &rdataset, NULL);
 	if (result != ISC_R_SUCCESS)
